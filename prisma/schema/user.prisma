model User {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email     String   @unique @db.VarChar
  password  String   @db.VarChar
  firstName String   @default("") @db.VarChar
  lastName  String   @default("") @db.VarChar

  // 邮箱验证
  emailVerified         Boolean   @default(false)
  verificationCode      String?   @db.VarChar
  verificationCodeExpiry DateTime? @db.Timestamp(6)

  // 密码重置
  resetPasswordCode       String?   @db.VarChar
  resetPasswordCodeExpiry DateTime? @db.Timestamp(6)

  // 刷新令牌
  refreshTokens RefreshToken[]

  createdAt DateTime @default(now()) @db.Timestamp(6)
  updatedAt DateTime @default(now()) @updatedAt @db.Timestamp(6)

  @@map("users")
}

model RefreshToken {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  token     String   @unique @db.VarChar
  userId    String   @db.Uuid
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  expiresAt DateTime @db.Timestamp(6)
  createdAt DateTime @default(now()) @db.Timestamp(6)

  @@index([userId])
  @@map("refresh_tokens")
}
